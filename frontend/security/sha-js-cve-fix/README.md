# CVE-2025-9288 漏洞演示

## 漏洞概述

CVE-2025-9288 是 sha.js 库中的一个严重漏洞（CVSS 9.1），由于输入类型检查缺失导致多种攻击向量。该库周下载量超过1400万次，影响广泛。

## 攻击向量

根据漏洞分析，该漏洞允许攻击者实现四类危害：

1. **哈希状态回滚** - 输入 `{ length: -x }` 回滚内部状态
2. **数值误算与碰撞** - 构造数值溢出导致哈希碰撞
3. **拒绝服务（DoS）攻击** - 输入 `{ length: '1e99' }` 导致无限循环
4. **私钥提取** - 通过原型污染提取敏感信息

## 文件说明

- `CVE-2025-9288.js` - 完整漏洞演示文件，包含所有攻击向量和修复方案
- `package.json` - 项目依赖配置

## 运行演示

### 安装依赖

```bash
npm install
```

### 运行完整演示

```bash
node CVE-2025-9288.js
```

这个脚本会演示：
- ✅ 正常哈希计算
- 🚨 哈希状态回滚攻击
- 🔢 数值误算与碰撞攻击
- ⏰ 拒绝服务攻击
- 🔑 私钥提取攻击
- 🛡️ 各种修复方案

## 影响范围

- **受影响版本**: `sha.js@2.4.5–2.4.11` 和 `sha.js@3.2.4–3.2.8`
- **严重程度**: 严重（CVSS 9.1）
- **影响**: 加密机制破坏、私钥泄露、服务瘫痪

## 修复方案

### 1. 紧急升级

```bash
npm install sha.js@2.4.12 --save-exact
```

### 2. 输入验证

```javascript
function safeHash(input) {
  if (typeof input !== 'string' && !Buffer.isBuffer(input)) {
    throw new Error('Invalid input: Only string/Buffer allowed');
  }
  if (input.length > 1e6) throw new Error('Input exceeds maximum allowed size');
  return require('sha.js')(input);
}
```

### 3. 使用原生 crypto

```javascript
const crypto = require('crypto');
const hash = crypto.createHash('sha1').update(input).digest('hex');
```

## 安全建议

1. **立即行动**: 在72小时内完成漏洞修复
2. **依赖管理**: 锁定依赖版本，避免使用 `^` 和 `~`
3. **监控告警**: 部署异常哈希计算时长的监控
4. **安全审计**: 定期进行供应链安全审计
5. **防御纵深**: 实施多层防御策略

## 相关资源

- [漏洞详情分析](https://juejin.cn/post/7541719099627372580)
- [sha.js GitHub](https://github.com/crypto-browserify/sha.js)
- [OpenJS 安全公告](https://openjsf.org/)

## 免责声明

本演示仅用于教育和研究目的。在生产环境中，请遵循官方安全指导进行修复。
