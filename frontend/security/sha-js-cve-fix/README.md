# CVE-2025-9288 æ¼æ´æ¼”ç¤º

## æ¼æ´æ¦‚è¿°

CVE-2025-9288 æ˜¯ sha.js åº“ä¸­çš„ä¸€ä¸ªä¸¥é‡æ¼æ´ï¼ˆCVSS 9.1ï¼‰ï¼Œç”±äºè¾“å…¥ç±»å‹æ£€æŸ¥ç¼ºå¤±å¯¼è‡´å¤šç§æ”»å‡»å‘é‡ã€‚è¯¥åº“å‘¨ä¸‹è½½é‡è¶…è¿‡1400ä¸‡æ¬¡ï¼Œå½±å“å¹¿æ³›ã€‚

## æ”»å‡»å‘é‡

æ ¹æ®æ¼æ´åˆ†æï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…å®ç°å››ç±»å±å®³ï¼š

1. **å“ˆå¸ŒçŠ¶æ€å›æ»š** - è¾“å…¥ `{ length: -x }` å›æ»šå†…éƒ¨çŠ¶æ€
2. **æ•°å€¼è¯¯ç®—ä¸ç¢°æ’** - æ„é€ æ•°å€¼æº¢å‡ºå¯¼è‡´å“ˆå¸Œç¢°æ’
3. **æ‹’ç»æœåŠ¡ï¼ˆDoSï¼‰æ”»å‡»** - è¾“å…¥ `{ length: '1e99' }` å¯¼è‡´æ— é™å¾ªç¯
4. **ç§é’¥æå–** - é€šè¿‡åŸå‹æ±¡æŸ“æå–æ•æ„Ÿä¿¡æ¯

## æ–‡ä»¶è¯´æ˜

- `CVE-2025-9288.js` - å®Œæ•´æ¼æ´æ¼”ç¤ºæ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰æ”»å‡»å‘é‡å’Œä¿®å¤æ–¹æ¡ˆ
- `package.json` - é¡¹ç›®ä¾èµ–é…ç½®

## è¿è¡Œæ¼”ç¤º

### å®‰è£…ä¾èµ–

```bash
npm install
```

### è¿è¡Œå®Œæ•´æ¼”ç¤º

```bash
node CVE-2025-9288.js
```

è¿™ä¸ªè„šæœ¬ä¼šæ¼”ç¤ºï¼š
- âœ… æ­£å¸¸å“ˆå¸Œè®¡ç®—
- ğŸš¨ å“ˆå¸ŒçŠ¶æ€å›æ»šæ”»å‡»
- ğŸ”¢ æ•°å€¼è¯¯ç®—ä¸ç¢°æ’æ”»å‡»
- â° æ‹’ç»æœåŠ¡æ”»å‡»
- ğŸ”‘ ç§é’¥æå–æ”»å‡»
- ğŸ›¡ï¸ å„ç§ä¿®å¤æ–¹æ¡ˆ

## å½±å“èŒƒå›´

- **å—å½±å“ç‰ˆæœ¬**: `sha.js@2.4.5â€“2.4.11` å’Œ `sha.js@3.2.4â€“3.2.8`
- **ä¸¥é‡ç¨‹åº¦**: ä¸¥é‡ï¼ˆCVSS 9.1ï¼‰
- **å½±å“**: åŠ å¯†æœºåˆ¶ç ´åã€ç§é’¥æ³„éœ²ã€æœåŠ¡ç˜«ç—ª

## ä¿®å¤æ–¹æ¡ˆ

### 1. ç´§æ€¥å‡çº§

```bash
npm install sha.js@2.4.12 --save-exact
```

### 2. è¾“å…¥éªŒè¯

```javascript
function safeHash(input) {
  if (typeof input !== 'string' && !Buffer.isBuffer(input)) {
    throw new Error('Invalid input: Only string/Buffer allowed');
  }
  if (input.length > 1e6) throw new Error('Input exceeds maximum allowed size');
  return require('sha.js')(input);
}
```

### 3. ä½¿ç”¨åŸç”Ÿ crypto

```javascript
const crypto = require('crypto');
const hash = crypto.createHash('sha1').update(input).digest('hex');
```

## å®‰å…¨å»ºè®®

1. **ç«‹å³è¡ŒåŠ¨**: åœ¨72å°æ—¶å†…å®Œæˆæ¼æ´ä¿®å¤
2. **ä¾èµ–ç®¡ç†**: é”å®šä¾èµ–ç‰ˆæœ¬ï¼Œé¿å…ä½¿ç”¨ `^` å’Œ `~`
3. **ç›‘æ§å‘Šè­¦**: éƒ¨ç½²å¼‚å¸¸å“ˆå¸Œè®¡ç®—æ—¶é•¿çš„ç›‘æ§
4. **å®‰å…¨å®¡è®¡**: å®šæœŸè¿›è¡Œä¾›åº”é“¾å®‰å…¨å®¡è®¡
5. **é˜²å¾¡çºµæ·±**: å®æ–½å¤šå±‚é˜²å¾¡ç­–ç•¥

## ç›¸å…³èµ„æº

- [æ¼æ´è¯¦æƒ…åˆ†æ](https://juejin.cn/post/7541719099627372580)
- [sha.js GitHub](https://github.com/crypto-browserify/sha.js)
- [OpenJS å®‰å…¨å…¬å‘Š](https://openjsf.org/)

## å…è´£å£°æ˜

æœ¬æ¼”ç¤ºä»…ç”¨äºæ•™è‚²å’Œç ”ç©¶ç›®çš„ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¯·éµå¾ªå®˜æ–¹å®‰å…¨æŒ‡å¯¼è¿›è¡Œä¿®å¤ã€‚
